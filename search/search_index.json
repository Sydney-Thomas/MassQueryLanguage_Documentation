{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"What is Mass Spec Query Language \u00b6 The Mass Spec Query Langauge (MassQL) is a domain specific language meant to be a succinct way to express a query in a mass spectrometry centric fashion. It is inspired by SQL, but it attempts to bake in assumptions of mass spectrometry to make querying much more natural for mass spectrometry users. Broadly we attempt to design it according to several principles: Expressiveness - Capture complex mass spectrometry patterns that the community would like to look for Precision - Exactly prescribe how to find data without ambiguity Relatively Natural - MassQL should be relatively easy to read and write and even use as a way to communicate ideas about mass spectrometry, you know like a language. Developers \u00b6 Mingxun Wang is the creator and main developer of MassQL. Please contact me if you have questions! I'm hoping this becomes a community effort so reach out if you want to help/use MassQL. Definition of a Query \u00b6 There are several parts QUERY <Type of Data> WHERE <Condition> AND <Condition> FILTER <Filter> AND <Filter> Type of Data \u00b6 This determines the type of data you want to get. At its most fundamental level, its the peaks for either MS1DATA MS2DATA Further, there are functions that can modify this data scaninfo - This provides likely the most information you'd want for each scan scansum - Summation of the scan scannum - Returns the scan number Experimental Functions scanrangesum scanmaxint scanmaxmz scanrun Conditionals \u00b6 These are conditions to filter for scans of interest (by looking for peaks and sets of peaks) within the mass spectrometry data. You can create clauses, which are specific conditions and the associated qualifiers. You may further combine multiple conditions with AND operators. Info The syntax for this is <condition>=<value> , e.g. MS2PROD=144.1 . The types of conditions are as follows RTMIN \u00b6 Setting the minimum retention time in minutes RTMAX \u00b6 Setting the maximum retention time in minutes SCANMIN \u00b6 Setting the minimum scan number (this is inclusive) SCANMAX \u00b6 Setting the maximum scan number (this is inclusive) CHARGE \u00b6 Finding MS2 spectra with a given charge if reported by the instrument POLARITY \u00b6 The polarity that will be chosen. (Positive, Negative) MS2PROD \u00b6 Looking for an MS2 peak MS2PREC \u00b6 Looking for an MS2 precursor m/z MS2NL \u00b6 Looking for a neutral loss from precursor in the MS2 spectrum Qualifiers \u00b6 These can be attached to conditions to modify some properties about the peaks we are looking for. Mass Accuracy \u00b6 These two fields enable setting a peak m/z tolerance TOLERANCEMZ=0.1 TOLERANCEPPM=50 Intensity Relative to Full Spectrum \u00b6 These two fields enable to set an minimum intensity INTENSITYVALUE=1000 INTENSITYPERCENT=10 INTENSITYTICPERCENT=10 INTENSITYVALUE - This indicates a minimum intensity value in terms of arbitrary units. INTENSITYPERCENT - This indicates a minimum percent of maximum peak in the spectrum. INTENSITYTICPERCENT - This indicates a minimum percent of total TIC in the spectra. Intensity Relative to Other Peaks \u00b6 Here we can start imposing relative intensities between peaks INTENSITYMATCHREFERENCE INTENSITYMATCH=Y INTENSITYMATCH=Y*2 INTENSITYMATCHPERCENT=10 Intensity Matching Between Peaks This is actually complicated, but you'll end up with one peak per variable that is the reference and all others are relative to that reference. WHERE MS1MZ=X:INTENSITYMATCH=Y:INTENSITYMATCHREFERENCE # This is the reference peak which all other peaks' intensities will be compared to AND MS1MZ=X+2:INTENSITYMATCH=Y*2:INTENSITYMATCHPERCENT=1 # The Y*2 denotes that it must be 2 times the intensity of the first peak Values of Conditions, Qualifiers \u00b6 As mentioned above, the value of certain conditions can be numbers (more precisely floats). However, its sometimes in convenient to have to actually calculate out the m/z for an MS2PROD condition and also the derivation is obfuscated if its just a single number. You can simply list it out as a numerical expression MS2PROD=100+14 and this will get calculated to mean MS2PROD=114 You can even do more advanced things that are native to chemistry/biochemistry without having to look up numbers, and they are listed below Molecular Formula \u00b6 To save us all a little bit of time convert lookup of formulas into masses, you can use the syntax: MS2PROD=formula(H2O) to easily calcualte the mono isotopic mass of H2O. It will substitute as MS2PROD=18.01056468403 Advanced Usage If you want to make functions out of formula masses, you totally can, like below MS2PROD=100 + formula(CH2)*2 Amino Acid Masses \u00b6 To calculate amino acid masses, you can use the following syntax MS2PROD=100 + aminoaciddelta(G) which will calculate out to MS2PROD=157.02146372057 Multiple Amino Acids If you want to use multiple amino acids, no problem: MS2PROD=aminoaciddelta(GA) Peptide Masses \u00b6 If you're in the proteomics camp, you can automatically calculate peptide fragementation. MS2PROD=peptide(G, charge=1, ion=y) will yield MS2PROD=76.03930487103999 Filters \u00b6 Filters are like conditional but we don't elimate scans based on the condition. Rather, we simply filter out peaks within the spectra. This is useful for things like SRM or SIM/XIC. MassQL Patterns \u00b6 If you're interested in doing some more advanced queries in MassQL, we have a dedicated patterns page to show you ways we've approached some interesting applications. By no means is it comprehensive, but we hope it helps. Check it out patterns.md . Examples \u00b6 XIC Generation \u00b6 MS1 XIC, m/z = 100 QUERY scansum(MS1DATA) FILTER MS1MZ=100:TOLERANCEMZ=0.1 MS2 With Sugar Loss - Neutral Loss Scan \u00b6 Neutral Loss, 163 Da QUERY scaninfo(MS2DATA) WHERE MS2NL=163 Brominated Compounds \u00b6 QUERY scaninfo(MS2DATA) WHERE MS1MZ=X:INTENSITYMATCH=Y:INTENSITYMATCHREFERENCE AND MS1MZ=X+2:INTENSITYMATCH=Y:INTENSITYMATCHPERCENT=5 AND MS2PREC=X MS2 with distinct fragment(s) - Precursor Ion Scan \u00b6 One Product Ion, m/z = 660.2 QUERY scaninfo(MS2DATA) WHERE MS2PROD=660.2:TOLERANCEMZ=0.1 Two Product Ions, m/z = 660.2 and 468.2 QUERY scaninfo(MS2DATA) WHERE MS2PROD=660.2:TOLERANCEMZ=0.1 AND MS2PROD=468.2:TOLERANCEMZ=0.1 How To Use MassQL \u00b6 Python API \u00b6 We have a python API that you can utilize in your own software. Commandline Utility \u00b6 We have a standalone script that can execute queries on single spectrum files. Nextflow Workflow \u00b6 We have a nextflow workflow to enable scalable queries across hundreds of thousands of mass spectrometry files. ProteoSAFe Workflow \u00b6 We have a proteosafe workflow that we have created that nicely integrates into GNPS - Try the beta here . Workflow Details \u00b6 There are several options that you probably will care about Extracting found MS scans as part of output, default this is off, if you want to do downstream molecular networking - turn this on If you want to run multiple queries together, you can now, just separate your queries with ||| and then results from multiple queries will be merged together Web API \u00b6 We have built out a web API for people to use, especially for parsing. https://msql.ucsd.edu/parse?query=QUERY%20MS2DATA%20WHERE%20MS1MZ=100 Simply put in the query as a url encoded parameter and a JSON representation of the parse is returned. Interactive Web Sandbox \u00b6 Checkout the interactive sandbox here . Debugging Your Query \u00b6 I would recommend you check out the interactive sandbox listed above. One of the features here is we try to translate your MassQL query into a visualization and into English. Generally issues with queries run into problems with of misunderstanding what each condition and qualifier mean or setting your requirements a bit too strict. Both the visualization and translation to English helps with that.","title":"MassQL Introduction"},{"location":"#what-is-mass-spec-query-language","text":"The Mass Spec Query Langauge (MassQL) is a domain specific language meant to be a succinct way to express a query in a mass spectrometry centric fashion. It is inspired by SQL, but it attempts to bake in assumptions of mass spectrometry to make querying much more natural for mass spectrometry users. Broadly we attempt to design it according to several principles: Expressiveness - Capture complex mass spectrometry patterns that the community would like to look for Precision - Exactly prescribe how to find data without ambiguity Relatively Natural - MassQL should be relatively easy to read and write and even use as a way to communicate ideas about mass spectrometry, you know like a language.","title":"What is Mass Spec Query Language"},{"location":"#developers","text":"Mingxun Wang is the creator and main developer of MassQL. Please contact me if you have questions! I'm hoping this becomes a community effort so reach out if you want to help/use MassQL.","title":"Developers"},{"location":"#definition-of-a-query","text":"There are several parts QUERY <Type of Data> WHERE <Condition> AND <Condition> FILTER <Filter> AND <Filter>","title":"Definition of a Query"},{"location":"#type-of-data","text":"This determines the type of data you want to get. At its most fundamental level, its the peaks for either MS1DATA MS2DATA Further, there are functions that can modify this data scaninfo - This provides likely the most information you'd want for each scan scansum - Summation of the scan scannum - Returns the scan number Experimental Functions scanrangesum scanmaxint scanmaxmz scanrun","title":"Type of Data"},{"location":"#conditionals","text":"These are conditions to filter for scans of interest (by looking for peaks and sets of peaks) within the mass spectrometry data. You can create clauses, which are specific conditions and the associated qualifiers. You may further combine multiple conditions with AND operators. Info The syntax for this is <condition>=<value> , e.g. MS2PROD=144.1 . The types of conditions are as follows","title":"Conditionals"},{"location":"#rtmin","text":"Setting the minimum retention time in minutes","title":"RTMIN"},{"location":"#rtmax","text":"Setting the maximum retention time in minutes","title":"RTMAX"},{"location":"#scanmin","text":"Setting the minimum scan number (this is inclusive)","title":"SCANMIN"},{"location":"#scanmax","text":"Setting the maximum scan number (this is inclusive)","title":"SCANMAX"},{"location":"#charge","text":"Finding MS2 spectra with a given charge if reported by the instrument","title":"CHARGE"},{"location":"#polarity","text":"The polarity that will be chosen. (Positive, Negative)","title":"POLARITY"},{"location":"#ms2prod","text":"Looking for an MS2 peak","title":"MS2PROD"},{"location":"#ms2prec","text":"Looking for an MS2 precursor m/z","title":"MS2PREC"},{"location":"#ms2nl","text":"Looking for a neutral loss from precursor in the MS2 spectrum","title":"MS2NL"},{"location":"#qualifiers","text":"These can be attached to conditions to modify some properties about the peaks we are looking for.","title":"Qualifiers"},{"location":"#mass-accuracy","text":"These two fields enable setting a peak m/z tolerance TOLERANCEMZ=0.1 TOLERANCEPPM=50","title":"Mass Accuracy"},{"location":"#intensity-relative-to-full-spectrum","text":"These two fields enable to set an minimum intensity INTENSITYVALUE=1000 INTENSITYPERCENT=10 INTENSITYTICPERCENT=10 INTENSITYVALUE - This indicates a minimum intensity value in terms of arbitrary units. INTENSITYPERCENT - This indicates a minimum percent of maximum peak in the spectrum. INTENSITYTICPERCENT - This indicates a minimum percent of total TIC in the spectra.","title":"Intensity Relative to Full Spectrum"},{"location":"#intensity-relative-to-other-peaks","text":"Here we can start imposing relative intensities between peaks INTENSITYMATCHREFERENCE INTENSITYMATCH=Y INTENSITYMATCH=Y*2 INTENSITYMATCHPERCENT=10 Intensity Matching Between Peaks This is actually complicated, but you'll end up with one peak per variable that is the reference and all others are relative to that reference. WHERE MS1MZ=X:INTENSITYMATCH=Y:INTENSITYMATCHREFERENCE # This is the reference peak which all other peaks' intensities will be compared to AND MS1MZ=X+2:INTENSITYMATCH=Y*2:INTENSITYMATCHPERCENT=1 # The Y*2 denotes that it must be 2 times the intensity of the first peak","title":"Intensity Relative to Other Peaks"},{"location":"#values-of-conditions-qualifiers","text":"As mentioned above, the value of certain conditions can be numbers (more precisely floats). However, its sometimes in convenient to have to actually calculate out the m/z for an MS2PROD condition and also the derivation is obfuscated if its just a single number. You can simply list it out as a numerical expression MS2PROD=100+14 and this will get calculated to mean MS2PROD=114 You can even do more advanced things that are native to chemistry/biochemistry without having to look up numbers, and they are listed below","title":"Values of Conditions, Qualifiers"},{"location":"#molecular-formula","text":"To save us all a little bit of time convert lookup of formulas into masses, you can use the syntax: MS2PROD=formula(H2O) to easily calcualte the mono isotopic mass of H2O. It will substitute as MS2PROD=18.01056468403 Advanced Usage If you want to make functions out of formula masses, you totally can, like below MS2PROD=100 + formula(CH2)*2","title":"Molecular Formula"},{"location":"#amino-acid-masses","text":"To calculate amino acid masses, you can use the following syntax MS2PROD=100 + aminoaciddelta(G) which will calculate out to MS2PROD=157.02146372057 Multiple Amino Acids If you want to use multiple amino acids, no problem: MS2PROD=aminoaciddelta(GA)","title":"Amino Acid Masses"},{"location":"#peptide-masses","text":"If you're in the proteomics camp, you can automatically calculate peptide fragementation. MS2PROD=peptide(G, charge=1, ion=y) will yield MS2PROD=76.03930487103999","title":"Peptide Masses"},{"location":"#filters","text":"Filters are like conditional but we don't elimate scans based on the condition. Rather, we simply filter out peaks within the spectra. This is useful for things like SRM or SIM/XIC.","title":"Filters"},{"location":"#massql-patterns","text":"If you're interested in doing some more advanced queries in MassQL, we have a dedicated patterns page to show you ways we've approached some interesting applications. By no means is it comprehensive, but we hope it helps. Check it out patterns.md .","title":"MassQL Patterns"},{"location":"#examples","text":"","title":"Examples"},{"location":"#xic-generation","text":"MS1 XIC, m/z = 100 QUERY scansum(MS1DATA) FILTER MS1MZ=100:TOLERANCEMZ=0.1","title":"XIC Generation"},{"location":"#ms2-with-sugar-loss-neutral-loss-scan","text":"Neutral Loss, 163 Da QUERY scaninfo(MS2DATA) WHERE MS2NL=163","title":"MS2 With Sugar Loss - Neutral Loss Scan"},{"location":"#brominated-compounds","text":"QUERY scaninfo(MS2DATA) WHERE MS1MZ=X:INTENSITYMATCH=Y:INTENSITYMATCHREFERENCE AND MS1MZ=X+2:INTENSITYMATCH=Y:INTENSITYMATCHPERCENT=5 AND MS2PREC=X","title":"Brominated Compounds"},{"location":"#ms2-with-distinct-fragments-precursor-ion-scan","text":"One Product Ion, m/z = 660.2 QUERY scaninfo(MS2DATA) WHERE MS2PROD=660.2:TOLERANCEMZ=0.1 Two Product Ions, m/z = 660.2 and 468.2 QUERY scaninfo(MS2DATA) WHERE MS2PROD=660.2:TOLERANCEMZ=0.1 AND MS2PROD=468.2:TOLERANCEMZ=0.1","title":"MS2 with distinct fragment(s) - Precursor Ion Scan"},{"location":"#how-to-use-massql","text":"","title":"How To Use MassQL"},{"location":"#python-api","text":"We have a python API that you can utilize in your own software.","title":"Python API"},{"location":"#commandline-utility","text":"We have a standalone script that can execute queries on single spectrum files.","title":"Commandline Utility"},{"location":"#nextflow-workflow","text":"We have a nextflow workflow to enable scalable queries across hundreds of thousands of mass spectrometry files.","title":"Nextflow Workflow"},{"location":"#proteosafe-workflow","text":"We have a proteosafe workflow that we have created that nicely integrates into GNPS - Try the beta here .","title":"ProteoSAFe Workflow"},{"location":"#workflow-details","text":"There are several options that you probably will care about Extracting found MS scans as part of output, default this is off, if you want to do downstream molecular networking - turn this on If you want to run multiple queries together, you can now, just separate your queries with ||| and then results from multiple queries will be merged together","title":"Workflow Details"},{"location":"#web-api","text":"We have built out a web API for people to use, especially for parsing. https://msql.ucsd.edu/parse?query=QUERY%20MS2DATA%20WHERE%20MS1MZ=100 Simply put in the query as a url encoded parameter and a JSON representation of the parse is returned.","title":"Web API"},{"location":"#interactive-web-sandbox","text":"Checkout the interactive sandbox here .","title":"Interactive Web Sandbox"},{"location":"#debugging-your-query","text":"I would recommend you check out the interactive sandbox listed above. One of the features here is we try to translate your MassQL query into a visualization and into English. Generally issues with queries run into problems with of misunderstanding what each condition and qualifier mean or setting your requirements a bit too strict. Both the visualization and translation to English helps with that.","title":"Debugging Your Query"},{"location":"gnps/","text":"GNPS MassQL Workflow \u00b6 You can execute your MassQL queries against your own data or public data at GNPS in a highthroughput fashion. Whether its one file or 150K, its possible at GNPS. Linkouts \u00b6 Lorem Ipsum Extraction \u00b6 Lorem Ipsum Molecular Networking \u00b6 Lorem Ipsum Examples \u00b6 Sanity Test \u00b6 Link Iron Siderophore \u00b6 Link","title":"MassQL GNPS Workflow"},{"location":"gnps/#gnps-massql-workflow","text":"You can execute your MassQL queries against your own data or public data at GNPS in a highthroughput fashion. Whether its one file or 150K, its possible at GNPS.","title":"GNPS MassQL Workflow"},{"location":"gnps/#linkouts","text":"Lorem Ipsum","title":"Linkouts"},{"location":"gnps/#extraction","text":"Lorem Ipsum","title":"Extraction"},{"location":"gnps/#molecular-networking","text":"Lorem Ipsum","title":"Molecular Networking"},{"location":"gnps/#examples","text":"","title":"Examples"},{"location":"gnps/#sanity-test","text":"Link","title":"Sanity Test"},{"location":"gnps/#iron-siderophore","text":"Link","title":"Iron Siderophore"},{"location":"patterns/","text":"This page includes common patterns that you might want to query for in mass spec data MS2 spectra with a given MS1 isotopic pattern \u00b6 If you're looking for molecules with an isotopic pattern and want to get the MS2 spectra associated with it, we have a pretty easy way to do this. Since you're looking for a variable m/z denoted as X, once you find it, simply enforce the MS2 precursor m/z to also be X. Note This will cause isotopic patterns that lack MS2 to be dropped Here is a quick example of a query QUERY scaninfo(MS2DATA) WHERE MS1MZ=X AND MS1MZ=X+1 AND MS2PREC=X","title":"MassQL Patterns"},{"location":"patterns/#ms2-spectra-with-a-given-ms1-isotopic-pattern","text":"If you're looking for molecules with an isotopic pattern and want to get the MS2 spectra associated with it, we have a pretty easy way to do this. Since you're looking for a variable m/z denoted as X, once you find it, simply enforce the MS2 precursor m/z to also be X. Note This will cause isotopic patterns that lack MS2 to be dropped Here is a quick example of a query QUERY scaninfo(MS2DATA) WHERE MS1MZ=X AND MS1MZ=X+1 AND MS2PREC=X","title":"MS2 spectra with a given MS1 isotopic pattern"}]}